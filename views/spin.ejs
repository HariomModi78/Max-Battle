<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    
    <link rel="stylesheet" href="/stylesheets/boiler.css">
    <link rel="stylesheet" href="/stylesheets/wallet.css">
    <link rel="stylesheet" href="/stylesheets/footer.css">
    <link rel="stylesheet" href="/stylesheets/spin.css">
    <link rel="stylesheet" href="/stylesheets/header.css">



    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#007bff">
</head>
<body>
    
        
    <main>
        <div class="disconnect">
            <img src="/images/disconnect.webp" alt="">
        </div>
        <div class="header">
            <div class="logo back" id="">
                <img loading="lazy" style="height: 2rem;width: 2rem;" id="home" src="https://cdn-icons-png.flaticon.com/128/3114/3114883.png" alt="">
            </div>
            <div class="greet">
                <p class="big">Daily Spin</p>
            </div>
            <div class="notification">
                <!-- <img loading="lazy" src="https://cdn-icons-png.flaticon.com/128/2311/2311524.png" alt=""> -->
            </div>
        </div>
        <div class="fakeHeader">
        <div class="fakeHeader">

        </div>
        <div id="pageLoader">
            <div class="skeleton-card">
                <div class="skeleton-thumbnail"></div>
                <div class="skeleton-text"></div>
                <div class="skeleton-text short"></div>
            </div>
            <div class="skeleton-card">
                <div class="skeleton-thumbnail"></div>
                <div class="skeleton-text"></div>
                <div class="skeleton-text short"></div>
            </div>
        </div>
        <div class="page">
            
            <div class="amount">
                Total Balance :
                <img loading="lazy" class="smallCoin" src="https://cdn-icons-png.flaticon.com/128/9382/9382295.png" alt="">
                <%=user.totalBalance.toLocaleString("en-IN")%>
            </div>
            
            
            <div class="winning">
                <div class="cong">Congratulations</div>
                <div class="upperPart">
                    <div class="winGreet">You Won</div>
                    üíµ5
                </div>
            </div>
            <div class="winning loss">
                <div class="upperPart">
                    Better luck next time
                </div>
            </div>
            <!-- <img class="image" src="/images/try.png" alt="asdf"> -->
            <div class="spin" id="<%=user._id%>">
                <div class="reward paddingRight">"Better luck"</div>
                <div class="reward">üíµ0.1 </div>
                <div class="reward">üíµ0.2 </div>
                <div class="reward">üíµ0.3 </div>
                <div class="reward paddingLeft">"Better luck"</div>
                <div class="reward">üíµ0.1 </div>
                <div class="reward">üíµ1 </div>
                <div class="reward">üíµ0.3 </div>
            </div>
            <div class="triangle"></div>
        </div>
          <div class="footer">
            <%
 const totalSeconds = Math.floor(timeLeft / 1000);
  const hours = Math.floor(totalSeconds / 3600);
  const minutes = Math.floor((totalSeconds % 3600) / 60);
  const seconds = totalSeconds % 60;
            %>
            <%if(timeLeft){%>
                <div class="timeLeft">‚è≥<%=hours%>hr <%=minutes%>min <%=seconds%>sec </div>
            <%}else{%>
                <div class="button">Spin & Win </div>
            <%}%>
            
            
          </div>  
    </main>
    <script>
  // Replace this value with actual remaining time from backend (in milliseconds)
  let remainingTime = <%= timeLeft %>; // Example: 3780000 for 1h 3m

  function formatTime(ms) {
    const totalSeconds = Math.floor(ms / 1000);
    const hours = Math.floor(totalSeconds / 3600);
    const minutes = Math.floor((totalSeconds % 3600) / 60);
    const seconds = totalSeconds % 60;
    return { hours, minutes, seconds };
  }

  function updateTimer() {
    if (remainingTime <= 0) {
      document.querySelector(".timeLeft").innerText = "‚úÖ Ready to Spin!";
      clearInterval(timer);
      return;
    }

    const { hours, minutes, seconds } = formatTime(remainingTime);
    document.querySelector(".timeLeft").innerText =
      `‚è≥ ${hours}hr ${minutes}min ${seconds}sec`;

    remainingTime -= 1000; // decrease 1 second
  }

  // Update every second
  updateTimer(); // initial call
  const timer = setInterval(updateTimer, 1000);
</script>

    <script src="/javaScripts/spin.js"></script>
    <script src="/javaScripts/boiler.js"></script>
    <script src="/javaScripts/back.js"></script>
    <script type="module" src="/script.js"></script>
    
</body>
</html>